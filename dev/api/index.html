<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · LearningPi.jl</title><meta name="title" content="API reference · LearningPi.jl"/><meta property="og:title" content="API reference · LearningPi.jl"/><meta property="twitter:title" content="API reference · LearningPi.jl"/><meta name="description" content="Documentation for LearningPi.jl."/><meta property="og:description" content="Documentation for LearningPi.jl."/><meta property="twitter:description" content="Documentation for LearningPi.jl."/><meta property="og:url" content="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/Learning_Lagrangian_Multipliers.jl/api/"/><meta property="twitter:url" content="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/Learning_Lagrangian_Multipliers.jl/api/"/><link rel="canonical" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/Learning_Lagrangian_Multipliers.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LearningPi.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Loss/">Loss Functions</a></li><li><a class="tocitem" href="../Models/">Machine Learning Models</a></li><li><a class="tocitem" href="../Sampling/">Sampling Mechanism</a></li><li><a class="tocitem" href="../Training/">Training Scripts</a></li><li class="is-active"><a class="tocitem" href>API reference</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Public"><span>Public</span></a></li><li><a class="tocitem" href="#Private"><span>Private</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-for-learning_pi.jl"><a class="docs-heading-anchor" href="#API-for-learning_pi.jl">API for learning_pi.jl</a><a id="API-for-learning_pi.jl-1"></a><a class="docs-heading-anchor-permalink" href="#API-for-learning_pi.jl" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#LearningPi.Corpus"><code>LearningPi.Corpus</code></a></li><li><a href="#LearningPi.Graphormer-Tuple{Any}"><code>LearningPi.Graphormer</code></a></li><li><a href="#LearningPi.LayerNorm-Tuple{Any}"><code>LearningPi.LayerNorm</code></a></li><li><a href="#LearningPi.LayerNorm"><code>LearningPi.LayerNorm</code></a></li><li><a href="#LearningPi.RMSNorm"><code>LearningPi.RMSNorm</code></a></li><li><a href="#LearningPi.abstract_dataset"><code>LearningPi.abstract_dataset</code></a></li><li><a href="#LearningPi.abstract_deviation"><code>LearningPi.abstract_deviation</code></a></li><li><a href="#LearningPi.abstract_example"><code>LearningPi.abstract_example</code></a></li><li><a href="#LearningPi.abstract_features_matrix"><code>LearningPi.abstract_features_matrix</code></a></li><li><a href="#LearningPi.cr_deviation"><code>LearningPi.cr_deviation</code></a></li><li><a href="#LearningPi.cr_features_matrix"><code>LearningPi.cr_features_matrix</code></a></li><li><a href="#LearningPi.featuresCWL"><code>LearningPi.featuresCWL</code></a></li><li><a href="#LearningPi.featuresGA"><code>LearningPi.featuresGA</code></a></li><li><a href="#LearningPi.featuresMCND"><code>LearningPi.featuresMCND</code></a></li><li><a href="#LearningPi.labels"><code>LearningPi.labels</code></a></li><li><a href="#LearningPi.labelsCWL"><code>LearningPi.labelsCWL</code></a></li><li><a href="#LearningPi.labelsGA"><code>LearningPi.labelsGA</code></a></li><li><a href="#LearningPi.learningType"><code>LearningPi.learningType</code></a></li><li><a href="#LearningPi.loss_hinge"><code>LearningPi.loss_hinge</code></a></li><li><a href="#LearningPi.loss_hinge-Tuple{Any}"><code>LearningPi.loss_hinge</code></a></li><li><a href="#LearningPi.loss_mse-Tuple{Any}"><code>LearningPi.loss_mse</code></a></li><li><a href="#LearningPi.lr_features_matrix"><code>LearningPi.lr_features_matrix</code></a></li><li><a href="#LearningPi.without_cr_features_matrix"><code>LearningPi.without_cr_features_matrix</code></a></li><li><a href="#LearningPi.zero_deviation"><code>LearningPi.zero_deviation</code></a></li><li><a href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_hinge, AbstractArray}"><code>ChainRulesCore.rrule</code></a></li><li><a href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_LR_gpu, AbstractArray}"><code>ChainRulesCore.rrule</code></a></li><li><a href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_LR, AbstractArray}"><code>ChainRulesCore.rrule</code></a></li><li><a href="#LearningPi.compareWithBests-Tuple{Dict, Dict, Any, Any}"><code>LearningPi.compareWithBests</code></a></li><li><a href="#LearningPi.createCorpus"><code>LearningPi.createCorpus</code></a></li><li><a href="#LearningPi.createDataSet"><code>LearningPi.createDataSet</code></a></li><li><a href="#LearningPi.createDataSet"><code>LearningPi.createDataSet</code></a></li><li><a href="#LearningPi.createEmptyDataset-Tuple{LearningPi.learningMLP}"><code>LearningPi.createEmptyDataset</code></a></li><li><a href="#LearningPi.createEmptyDataset-Tuple{LearningPi.learningGNN}"><code>LearningPi.createEmptyDataset</code></a></li><li><a href="#LearningPi.createKfold"><code>LearningPi.createKfold</code></a></li><li><a href="#LearningPi.createLabels-Tuple{Any, Any, Any, Any, instanceCWL}"><code>LearningPi.createLabels</code></a></li><li><a href="#LearningPi.createLabels-Tuple{Any, Any, Any, Instances.instanceGA}"><code>LearningPi.createLabels</code></a></li><li><a href="#LearningPi.createLabels-Tuple{Any, Any, Any, Any, Any, abstractInstanceMCND}"><code>LearningPi.createLabels</code></a></li><li><a href="#LearningPi.create_example-Tuple{LearningPi.learningMLP, String, abstractInstanceFactory, Any}"><code>LearningPi.create_example</code></a></li><li><a href="#LearningPi.create_example-Tuple{LearningPi.learningGNN, String, abstractInstanceFactory, LearningPi.abstract_features_matrix}"><code>LearningPi.create_example</code></a></li><li><a href="#LearningPi.create_features-Tuple{instanceCWL}"><code>LearningPi.create_features</code></a></li><li><a href="#LearningPi.create_features-Tuple{Instances.instanceGA}"><code>LearningPi.create_features</code></a></li><li><a href="#LearningPi.create_features-Tuple{cpuInstanceMCND}"><code>LearningPi.create_features</code></a></li><li><a href="#LearningPi.create_loss"><code>LearningPi.create_loss</code></a></li><li><a href="#LearningPi.create_model"><code>LearningPi.create_model</code></a></li><li><a href="#LearningPi.create_rms-Tuple{Any}"><code>LearningPi.create_rms</code></a></li><li><a href="#LearningPi.dataLoader-Tuple{String, MCNDinstanceFactory}"><code>LearningPi.dataLoader</code></a></li><li><a href="#LearningPi.dataLoader-Tuple{String, cpuCWLinstanceFactory}"><code>LearningPi.dataLoader</code></a></li><li><a href="#LearningPi.dataLoader-Tuple{String, Instances.cpuGAinstanceFactory}"><code>LearningPi.dataLoader</code></a></li><li><a href="#LearningPi.deviationFrom-Tuple{Any, LearningPi.zero_deviation}"><code>LearningPi.deviationFrom</code></a></li><li><a href="#LearningPi.deviationFrom-Tuple{Any, LearningPi.cr_deviation}"><code>LearningPi.deviationFrom</code></a></li><li><a href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, abstractInstanceMCND, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a></li><li><a href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, instanceCWL, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a></li><li><a href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningMLP, Any, abstractInstance}"><code>LearningPi.featuresExtraction</code></a></li><li><a href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, Instances.instanceGA, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a></li><li><a href="#LearningPi.features_matrix-Tuple{abstractInstanceMCND, LearningPi.featuresMCND, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a></li><li><a href="#LearningPi.features_matrix-Tuple{Instances.instanceGA, Any, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a></li><li><a href="#LearningPi.features_matrix-Tuple{instanceCWL, Any, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a></li><li><a href="#LearningPi.gap-Tuple{LearningPi.abstract_example, Real, Real, Real}"><code>LearningPi.gap</code></a></li><li><a href="#LearningPi.gap_closure-Tuple{LearningPi.abstract_example, Real, Real, Real}"><code>LearningPi.gap_closure</code></a></li><li><a href="#LearningPi.get_cr_features-Tuple{LearningPi.lr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a></li><li><a href="#LearningPi.get_cr_features-Tuple{LearningPi.without_cr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a></li><li><a href="#LearningPi.get_cr_features-Tuple{LearningPi.cr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a></li><li><a href="#LearningPi.get_device-Tuple{LearningPi.abstract_loss}"><code>LearningPi.get_device</code></a></li><li><a href="#LearningPi.get_model-Tuple{LearningPi.Graphormer}"><code>LearningPi.get_model</code></a></li><li><a href="#LearningPi.get_parameters"><code>LearningPi.get_parameters</code></a></li><li><a href="#LearningPi.get_λ-Tuple{Any}"><code>LearningPi.get_λ</code></a></li><li><a href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, Instances.cpuInstanceGA}"><code>LearningPi.gradient_lsp</code></a></li><li><a href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceCWL}"><code>LearningPi.gradient_lsp</code></a></li><li><a href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceMCND}"><code>LearningPi.gradient_lsp</code></a></li><li><a href="#LearningPi.prediction-Tuple{Flux.Chain, Any, Any, LearningPi.learningMLP, LearningPi.abstract_deviation}"><code>LearningPi.prediction</code></a></li><li><a href="#LearningPi.printBests-Tuple{Dict, String}"><code>LearningPi.printBests</code></a></li><li><a href="#LearningPi.printMetrics-Tuple{Dict}"><code>LearningPi.printMetrics</code></a></li><li><a href="#LearningPi.print_best_models-Tuple{String, Dict}"><code>LearningPi.print_best_models</code></a></li><li><a href="#LearningPi.print_json-Tuple{Any, Any, Any, Any, cpuMCNDinstanceFactory}"><code>LearningPi.print_json</code></a></li><li><a href="#LearningPi.print_json-Tuple{instanceCWL, LearningPi.labelsCWL, LearningPi.featuresCWL, String}"><code>LearningPi.print_json</code></a></li><li><a href="#LearningPi.print_json-Tuple{Instances.instanceGA, LearningPi.labelsGA, LearningPi.featuresGA, String}"><code>LearningPi.print_json</code></a></li><li><a href="#LearningPi.read_labels-Tuple{String, instanceCWL}"><code>LearningPi.read_labels</code></a></li><li><a href="#LearningPi.read_labels-Tuple{String, Instances.instanceGA}"><code>LearningPi.read_labels</code></a></li><li><a href="#LearningPi.read_labels-Tuple{String, abstractInstanceMCND}"><code>LearningPi.read_labels</code></a></li><li><a href="#LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningType, Any, Int64, Int64, Any}"><code>LearningPi.saveHP</code></a></li><li><a href="#LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningGNN, LearningPi.abstract_features_matrix, LearningPi.abstract_deviation, Any, Int64, Int64, Vararg{Any, 7}}"><code>LearningPi.saveHP</code></a></li><li><a href="#LearningPi.sizeFeatures-Tuple{LearningPi.learningMLP, Any}"><code>LearningPi.sizeFeatures</code></a></li><li><a href="#LearningPi.size_features_constraint-Tuple{LearningPi.lr_features_matrix}"><code>LearningPi.size_features_constraint</code></a></li><li><a href="#LearningPi.size_features_constraint-Tuple{LearningPi.cr_features_matrix}"><code>LearningPi.size_features_constraint</code></a></li><li><a href="#LearningPi.size_features_constraint-Tuple{LearningPi.without_cr_features_matrix}"><code>LearningPi.size_features_constraint</code></a></li><li><a href="#LearningPi.size_features_variable-Tuple{LearningPi.lr_features_matrix}"><code>LearningPi.size_features_variable</code></a></li><li><a href="#LearningPi.size_features_variable-Tuple{LearningPi.cr_features_matrix}"><code>LearningPi.size_features_variable</code></a></li><li><a href="#LearningPi.size_features_variable-Tuple{LearningPi.without_cr_features_matrix}"><code>LearningPi.size_features_variable</code></a></li><li><a href="#LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.loss_hinge}"><code>LearningPi.sub_problem_value</code></a></li><li><a href="#LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.abstract_loss}"><code>LearningPi.sub_problem_value</code></a></li><li><a href="#LearningPi.testAndPrint-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}"><code>LearningPi.testAndPrint</code></a></li><li><a href="#LearningPi.train-Tuple{Int64, LearningPi.Corpus, Any, Flux.Optimise.Optimiser, LearningPi.abstract_loss}"><code>LearningPi.train</code></a></li><li><a href="#LearningPi.validation-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}"><code>LearningPi.validation</code></a></li></ul><h2 id="Public"><a class="docs-heading-anchor" href="#Public">Public</a><a id="Public-1"></a><a class="docs-heading-anchor-permalink" href="#Public" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createCorpus" href="#LearningPi.createCorpus"><code>LearningPi.createCorpus</code></a> — <span class="docstring-category">Function</span></header><section><div><p>createCorpus(featType::learningType, folder::String, maxInstance::Vector{Int64}=[-1, -1, -1],seed::Int64=0;factory::abstractInstanceFactory=cpuMCNDinstanceFactory(),pTrain::Float32=0.8,pVal::Float32=0.1)</p><p><strong>Arguments:</strong></p><ul><li><code>featType</code> : the type of the features instance.</li><li><code>folder</code> : the path to the directory that contains the json files that defines the instances (and the associated features and labels).</li><li><code>maxInstance</code> : a vector with three components.   that say how many instances take for the training/validation/test set.</li><li><code>seed</code> : a random seed used to select which instaces consider in the training/validation/test sets.</li><li><code>factory</code>: type of instance.</li><li><code>pTrain</code> : The percentage of training instances in the provided folder.</li><li><code>pVal</code> : The percentage of validation instances in the provided folder.</li></ul><p>Create a Corpus, that is a structure with three DataSet field for training,validation and test dataset. Note: The percentage for the test set will be 1-pTrain-pVal. It is important to select the percentage of training and validation in such a way that pTrain+pVal&lt;1 and both will be non-negative.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createDataSet" href="#LearningPi.createDataSet"><code>LearningPi.createDataSet</code></a> — <span class="docstring-category">Function</span></header><section><div><p>function createDataSet(lt::learningGNN, directory::String, maxInstance::Int64=-1, factory::abstractInstanceFactory)</p><pre><code class="nohighlight hljs">#Arguments:
	- `lt`:learning type, it should be a sub-type learningGNN 
	- `directory`: the path to the directory containing instances
	- `maxInstance`: maximum instance number 
	- `factory`: instance factory, generic sub-type of abstractInstanceFactory

Create and returns a dataset for the provided learning type `lt`, considering `maxInst` instances of the factory `factory`, contained in `directory`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createDataSet" href="#LearningPi.createDataSet"><code>LearningPi.createDataSet</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">createDataSet(lt::learningType, directory, maxInstance::Int64=-1,factory::abstractInstanceFactory=cpuMCNDinstanceFactory())</code></pre><p><strong>Arguments:</strong></p><ul><li><code>lt</code>: the learning type.</li><li><code>directory</code>: a list of paths to the instances.</li><li><code>maxInstance</code>: the maximum number of instances that we wat consider in the provided directory. By default is equal to <code>-1</code>, that means consider all the instances in the directory.</li><li><code>factory</code>: type of instance, the possibilities in this moment are cpuMCNDinstanceFactory() (that is Multi-Commodity Network-Design instances) and cpuCWLinstanceFactory() (for the Bin Packing instances).</li></ul><p>Create the dataset for the provided (general) learning type. return a dataSet structure of a proper type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createKfold" href="#LearningPi.createKfold"><code>LearningPi.createKfold</code></a> — <span class="docstring-category">Function</span></header><section><div><p>createKfold(featType::learningType, folder::String, maxInstance::Vector{Int64}=[-1, -1, -1],seed::Int64=0;factory::abstractInstanceFactory=cpuMCNDinstanceFactory(),k::Int64=1)</p><p><strong>Arguments:</strong></p><ul><li><code>featType</code> : the type of the features instance.</li><li><code>folder</code> : the path to the directory that contains the json files that defines the instances (and the associated features and labels).</li><li><code>maxInstance</code> : a vector with three components.   that say how many instances take for the training/validation/test set.</li><li><code>seed</code> : a random seed used to select which instaces consider in the training/validation/test sets.</li><li><code>factory</code>: type of instance.</li><li><code>k</code>: the fold that we want select as test set. Note: 1 &lt;= k &lt;= 10.</li></ul><p>Create a Corpus, that is a struct with three DataSet field for training/validation/test set</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createLabels-Tuple{Any, Any, Any, Any, Any, abstractInstanceMCND}" href="#LearningPi.createLabels-Tuple{Any, Any, Any, Any, Any, abstractInstanceMCND}"><code>LearningPi.createLabels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>createLabels(π, x, y, LRarcs, objLR, ins::abstractInstanceMCND)</p><p><strong>Arguments:</strong></p><ul><li><code>π</code>: a (optimal) Lagrangian multipliers vector</li><li><code>x</code>: the flow variables in the Lagrangian sub-problem, obtained afer the resolution of the sub-problem with multipliers π</li><li><code>y</code>: the design variables in the Lagrangian sub-problem, obtained afer the resolution of the sub-problem with multipliers π</li><li><code>LRarcs</code>: a vector containign the bounds for each edge of the Lagrangian sub-problem considering π as Lagrangian multipleirs vector</li><li><code>objLR</code>: the bound of the Lagrangian sub-problem considering π as Lagrangian multipleirs vector</li><li><code>ins</code>: the instance structure (standard instance formulation, without regularization).</li></ul><pre><code class="nohighlight hljs">For instance (not normalized), nothing to do, just return a proper label structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createLabels-Tuple{Any, Any, Any, Any, instanceCWL}" href="#LearningPi.createLabels-Tuple{Any, Any, Any, Any, instanceCWL}"><code>LearningPi.createLabels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function createLabels(π, x, y, objLR, ins::instanceCWL)</p><p>#Arguments:</p><p>-<code>π</code>: optimal lagrangian multipliers vector. -<code>x</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables that associate one items to a pack (using the optimal Lagrangian multipliers). -<code>y</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables say if we use or not a pack (using the optimal Lagrangian multipliers). -<code>objLR</code>: optimal value of the Lagrangian Dual</p><ul><li><code>ins</code>: instance object, it should be of type sub-type of instanceCWL </li></ul><p>Given all the fields construct a label structure for the Bin Packing Problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createLabels-Tuple{Any, Any, Any, Instances.instanceGA}" href="#LearningPi.createLabels-Tuple{Any, Any, Any, Instances.instanceGA}"><code>LearningPi.createLabels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function createLabels(π, x, objLR, ins::instanceGA)</p><p>#Arguments: 	-<code>π</code>: optimal lagrangian multipliers vector. 	-<code>x</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables that associate one items to a pack (using the optimal Lagrangian multipliers). 	-<code>objLR</code>: optimal value of the Lagrangian Dual</p><p>Given all the fields construct a label structure for the Bin Packing Problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_example-Tuple{LearningPi.learningGNN, String, abstractInstanceFactory, LearningPi.abstract_features_matrix}" href="#LearningPi.create_example-Tuple{LearningPi.learningGNN, String, abstractInstanceFactory, LearningPi.abstract_features_matrix}"><code>LearningPi.create_example</code></a> — <span class="docstring-category">Method</span></header><section><div><p>create_example(lt::learningGNN, fileName::String, factory::abstractInstanceFactory)</p><p>#Arguments:</p><ul><li><code>lt</code>: learning Type, this function works for all the learning types that use a graph representation of the instance</li><li><code>fileName</code>: path to the json that contains all the information to construct the learning sample starting from an instance, its features and the labels.</li><li><code>factory</code>: instance factory, it works for all the factory</li></ul><p>returns an gnnExample_instance with all the information useful for the training.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_example-Tuple{LearningPi.learningMLP, String, abstractInstanceFactory, Any}" href="#LearningPi.create_example-Tuple{LearningPi.learningMLP, String, abstractInstanceFactory, Any}"><code>LearningPi.create_example</code></a> — <span class="docstring-category">Method</span></header><section><div><p>create_example(lt::learningArc, fileName::String,factory::abstractInstanceFactory)</p><p><strong>Arguments:</strong></p><ul><li>lt: learning type, it should be learningMLP.</li><li>fileName: the name of the file json that contains the informations about the instance, its features and its labels.</li><li>factory: type of instance (it handle both with the normalized and un-normalized instances).</li></ul><p>Create a structure containing the instance, the extracted features and the associated labels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_loss" href="#LearningPi.create_loss"><code>LearningPi.create_loss</code></a> — <span class="docstring-category">Function</span></header><section><div><p>create<em>loss(</em>::HingeLoss)</p><p><strong>Arguments:</strong></p><p>-<code>:</code>: loss parameters, it should be a structure of type HingeLoss.   </p><p>return the loss correspondent to loss paramameters of type HingeLoss</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_model" href="#LearningPi.create_model"><code>LearningPi.create_model</code></a> — <span class="docstring-category">Function</span></header><section><div><p>create_model(lType::learningMLP, in, h, out=1, a=relu)</p><p><strong>Arguments:</strong></p><ul><li><code>lType</code>: general learningType.</li><li><code>in</code>: size of the input layer.</li><li><code>h</code>: a vector with the same length as the desired number of hidden layers and each component say how many nodes we want in the correspondent hidden layer.</li><li><code>out</code>: size of the output layer, by default is equal to one.</li><li><code>a</code>: the activation function for the hidden layers, by default is <code>relu</code>.</li></ul><p>This function creates a model for the provided learning type (in order to use this variant it should be learningArc). The model is a multi layer perceptron with <code>in</code> nodes in the first layer, <code>length(h)</code> hidden layers (the i-th layer has <code>h[i]</code> nodes) and <code>out</code> nodes in the output layer (by default 1). By default each hidden layer use a relu activation function (the input and output layers have no activation function).   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.dataLoader-Tuple{String, Instances.cpuGAinstanceFactory}" href="#LearningPi.dataLoader-Tuple{String, Instances.cpuGAinstanceFactory}"><code>LearningPi.dataLoader</code></a> — <span class="docstring-category">Method</span></header><section><div><p>dataLoader(fileName::String, factory::cpuGAinstanceFactory)</p><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">- `fileName` : a path to a json file that contains the data for the instance, features and labels
- `factory` : an instance factory for the Bin Packing problem</code></pre><p>It reads the instance, the features and the labels from the json and returns three structures that contains all the informations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.dataLoader-Tuple{String, MCNDinstanceFactory}" href="#LearningPi.dataLoader-Tuple{String, MCNDinstanceFactory}"><code>LearningPi.dataLoader</code></a> — <span class="docstring-category">Method</span></header><section><div><p>dataLoader(fileName::String, factory::MCNDnstanceFactory)</p><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">- `fileName` : a path to a json file that contains the data for the instance, features and labels
- `factory` : an instance object (for the same instance as the features file)</code></pre><p>It reads the instance, the features and the labels from the json and returns three structures that contains all the informations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.dataLoader-Tuple{String, cpuCWLinstanceFactory}" href="#LearningPi.dataLoader-Tuple{String, cpuCWLinstanceFactory}"><code>LearningPi.dataLoader</code></a> — <span class="docstring-category">Method</span></header><section><div><p>dataLoader(fileName::String, factory::cpuCWLinstanceFactory)</p><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">- `fileName` : a path to a json file that contains the data for the instance, features and labels
- `factory` : an instance factory for the Bin Packing problem</code></pre><p>It reads the instance, the features and the labels from the json located in <code>fileName</code> and returns three structures that contains all the informations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresExtraction-Tuple{LearningPi.learningMLP, Any, abstractInstance}" href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningMLP, Any, abstractInstance}"><code>LearningPi.featuresExtraction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>featuresExtraction(featType::learningMLP, featObj, ins)</p><p>Vectorization function for the features when we consider a learningNodeDemand encoding.</p><p><strong>Arguments:</strong></p><ul><li><code>featType</code> features type</li><li><code>features</code> a features matrix</li><li><code>nbFeatures</code> the number of features</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, Instances.instanceGA, LearningPi.abstract_features_matrix}" href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, Instances.instanceGA, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function featuresExtraction(lt::learningType, featObj, ins::instanceGA, fmt::abstract<em>features</em>matrix)</p><p>#Arguments:</p><ul><li><code>lt</code>: learnign type, it should be a sub-type of learningType</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>ins</code>: instance structure, it should instanceGA</li><li><code>fmt</code>: features matrix type.</li></ul><p>Returns the bipartite graph representation with the associated nodes-features matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, abstractInstanceMCND, LearningPi.abstract_features_matrix}" href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, abstractInstanceMCND, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function featuresExtraction(lt::learningGNN, featObj, ins::abstractInstanceMCND)</p><p>Arguments:</p><ul><li><code>lt</code>: learnign type, it should be a sub-type of learningGNN</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>ins</code>: instance structure, it should be a sub-type of abstractInstanceMCND</li></ul><p>Returns the bipartite graph representation with the associated nodes-features matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, instanceCWL, LearningPi.abstract_features_matrix}" href="#LearningPi.featuresExtraction-Tuple{LearningPi.learningType, Any, instanceCWL, LearningPi.abstract_features_matrix}"><code>LearningPi.featuresExtraction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function featuresExtraction(lt::learningType, featObj, ins::instanceCWL,fmt::abstract<em>features</em>matrix)</p><p>#Arguments:</p><ul><li><code>lt</code>: learnign type, it should be a sub-type of learningType</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>ins</code>: instance structure, it should instanceCWL</li><li><code>fmt</code>: features matrix type.</li></ul><p>Returns the bipartite graph representation with the associated nodes-features matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.prediction-Tuple{Flux.Chain, Any, Any, LearningPi.learningMLP, LearningPi.abstract_deviation}" href="#LearningPi.prediction-Tuple{Flux.Chain, Any, Any, LearningPi.learningMLP, LearningPi.abstract_deviation}"><code>LearningPi.prediction</code></a> — <span class="docstring-category">Method</span></header><section><div><p>prediction(nn, f,ins,lt::learningMLP)</p><p><strong>Arguments:</strong></p><p>-<code>nn</code>: neural network model. -<code>f</code>: features matrix. -<code>ins</code>: structure containing the instance informations. -<code>lt</code>: learning type (general).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.train-Tuple{Int64, LearningPi.Corpus, Any, Flux.Optimise.Optimiser, LearningPi.abstract_loss}" href="#LearningPi.train-Tuple{Int64, LearningPi.Corpus, Any, Flux.Optimise.Optimiser, LearningPi.abstract_loss}"><code>LearningPi.train</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function train(maxEp::Int64, dS::Corpus, nn, opt::Optimiser, loss::abstractLoss; printEpoch::Int64=10, endString::String, lt::learningType, dt::abstract_deviation,seed::Int64,bs::Int64=1)</p><p><strong>Arguments:</strong></p><ul><li><code>maxEp</code>: the maximum number of epochs for the learning algorithm.</li><li><code>dS</code>: the Corpus structure that contains the training, validation and test sets.</li><li><code>nn</code>: the neural network model.</li><li><code>opt</code>: the optimizer used for the training.</li><li><code>loss</code>: a structure that contains the parameters α and β of the loss.</li><li><code>printEpoch</code>: the number of epochs in which print the metrics of the training.</li><li><code>endString</code>: the string used to memorize the output files as best models and tensorboard logs.</li><li><code>dt</code>: deviation type, it could deviate from zero or the duals of the continuous relaxation.</li><li><code>lt</code>: learning type</li><li><code>seed</code>: random seed for the random generators</li><li><code>bs</code> batch size</li></ul><p>This function performs the learning with the provided inputs and save the best models in a bson file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><h2 id="Private"><a class="docs-heading-anchor" href="#Private">Private</a><a id="Private-1"></a><a class="docs-heading-anchor-permalink" href="#Private" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.Corpus" href="#LearningPi.Corpus"><code>LearningPi.Corpus</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Corpus structure contains the three datasets: training, validation and test set</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.Graphormer-Tuple{Any}" href="#LearningPi.Graphormer-Tuple{Any}"><code>LearningPi.Graphormer</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function (m::Graphormer)(x)</p><p><strong>Arguments:</strong></p><ul><li><code>x</code>: input of the NN model of type Graphormer    </li></ul><p>Forward computation of a Graphormer m, the output is the concatenation of all the multipliers predicted by the model   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.LayerNorm" href="#LearningPi.LayerNorm"><code>LearningPi.LayerNorm</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct LayerNorm</p><p>#Fields:</p><ul><li><code>eps</code>: regularization parameter</li><li><code>d</code>: size of the input of the normalization layer </li></ul><p>Describe the Layer Normalization for the provided parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.LayerNorm-Tuple{Any}" href="#LearningPi.LayerNorm-Tuple{Any}"><code>LearningPi.LayerNorm</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function (m::LayerNorm)(x)</p><p>Perform a Layer Normalization using <code>x</code> as input .</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.RMSNorm" href="#LearningPi.RMSNorm"><code>LearningPi.RMSNorm</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct RMSNorm</p><p>#Fields:</p><ul><li><code>eps</code>: additive regularization parameter</li><li><code>sqrtd</code>: multiplicative regularization parameter</li></ul><p>Describe the RMS Normalization for the provided parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.abstract_dataset" href="#LearningPi.abstract_dataset"><code>LearningPi.abstract_dataset</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Abstract type for the dataset</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.abstract_deviation" href="#LearningPi.abstract_deviation"><code>LearningPi.abstract_deviation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>abstract type abstract_deviation end</p><p>Abstract type to handle the deviation vector, i.e. the starting point from which our model produce an additive activation. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.abstract_example" href="#LearningPi.abstract_example"><code>LearningPi.abstract_example</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Abstract type for an element of a dataset</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.abstract_features_matrix" href="#LearningPi.abstract_features_matrix"><code>LearningPi.abstract_features_matrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>abstract type <code>abstract_features_matrix</code></p><p>Abstract type for the construction of the nodes-features matrix associated to the bipartite graph representation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.cr_deviation" href="#LearningPi.cr_deviation"><code>LearningPi.cr_deviation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct cr_deviation end</p><p>Type to use as deviation vector (i.e. the starting point from which our model produce an additive activation) the dual variables associated to the relaxed constraints in the optimal solution of the Continuous Relaxation. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.cr_features_matrix" href="#LearningPi.cr_features_matrix"><code>LearningPi.cr_features_matrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct <code>cr_features_matrix</code></p><p>with this choice the features matrix considers the informations related to the continuous relaxation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresCWL" href="#LearningPi.featuresCWL"><code>LearningPi.featuresCWL</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Features structure for the Bin Packing instance. #Fields: -<code>xCR</code>: primal solution of the Linear Relaxation associated to the variables that associate one items to a pack. -<code>yCR</code>: primal solution of the Linear Relaxation associated to the variables say if we use or not a pack. -<code>λ</code>: dual solution of the Linear Relaxation associated to the packing constraints. -<code>μ</code>: dual solution of the Linear Relaxation associated to the packing constraints. -<code>objCR</code>: objective value of the Linear Relaxation. -<code>xLR</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables that associate one items to a pack (using the dual variables λ of the linear relaxation). -<code>yLR</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables say if we use or not a pack (using the dual variables λ of the linear relaxation). -<code>objLR</code>: objective value of the Knapsack Lagrangian Relaxation (using the dual variables λ of the linear relaxation). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresGA" href="#LearningPi.featuresGA"><code>LearningPi.featuresGA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Features structure for the Bin Packing instance. #Fields: -<code>xCR</code>: primal solution of the Linear Relaxation associated to the variables that associate one items to a pack. -<code>λ</code>: dual solution of the Linear Relaxation associated to the packing constraints. -<code>μ</code>: dual solution of the Linear Relaxation associated to the packing constraints. -<code>objCR</code>: objective value of the Linear Relaxation. -<code>xLR</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables that associate one items to a pack (using the dual variables λ of the linear relaxation). -<code>objLR</code>: objective value of the Knapsack Lagrangian Relaxation (using the dual variables λ of the linear relaxation). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.featuresMCND" href="#LearningPi.featuresMCND"><code>LearningPi.featuresMCND</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct containing the information of the features for an instance.</p><p><strong>Fields:</strong></p><ul><li><code>xCR</code>: the value of the flow variables for the optimal solution of the linear relaxation.</li><li><code>yCR</code>: the value of the decision variables for the optimal solution of the linear relaxation.</li><li><code>λ</code>: the value of the dual variables associated to the flow constraints, for the optimal solution of the linear relaxation.</li><li><code>μ</code>: the value of the dual variables associated to the capacity constraints for the optimal solution of the linear relaxation.</li><li><code>objCR</code>: the objective value of the linear relaxation.</li><li><code>xLR</code>: the value of the flow variables for the optimal solution of the sub-problem for the knapsack relaxation, considering as lagrangian multiers the vector λ.</li><li><code>yLR</code>: the value of the design variables for the optimal solution of the sub-problem for the knapsack relaxation, considering as lagrangian multiers the vector λ.</li><li><code>LRarcs</code>: the objective values, for each edge, of the optimal solution of the sub-problem for the knapsack relaxation, considering as lagrangian multiers the vector λ.</li><li><code>objLR</code>: the objective value of the sub-problem for the knapsack relaxation, considering as lagrangian multiers the vector λ.</li><li><code>origins</code>: a matrix of size K×V the cost of the shortest path from the origin to the current node with costs in an edge e:  ins.r[k,e]+ins.f[e]/ins.c[e].</li><li><code>destinations</code>: a matrix of size K×V the cost of the shortest path from the current node to the destination with costs in an edge e:  ins.r[k,e]+ins.f[e]/ins.c[e].</li><li><code>distance</code>: a matrix of size V×V with the distance in terms of number of edges for the shortest path from each two nodes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.labels" href="#LearningPi.labels"><code>LearningPi.labels</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct containing the information relative to the labels</p><p><strong>Fields</strong></p><ul><li><code>π::Matrix{Float32}</code>: matrix containing the gold Lagrangian multipliers. π[k, i] gives the values of the Lagrangian multiplier associated with demand k and node i.</li><li><code>x::Matrix{Int16}</code>: solution x of the Lagrangian problem. x[k, a] gives the value of the solution x_a^k of the Lagrangian problem L(π) for demand k and arc a.</li><li><code>y::Vector{Int16}</code>: solution y of the Lagrangian problem. y[a] gives the value of the solution y_a of the Lagrangian problem L(π) for arc a.</li><li><code>LRarcs::Vector{Float32}</code>: Values of the Lagrangian problem for the arcs. LRarcs[a] gives the value of subproblem L_a associated with arc a.</li><li><code>objLR::Float32</code>: Value of the Lagrangian dual problem</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.labelsCWL" href="#LearningPi.labelsCWL"><code>LearningPi.labelsCWL</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Label structure for the Bin Packing Problem. 	#Fields: 	-<code>π</code>: optimal lagrangian multipliers vector. 	-<code>xLR</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables that associate one items to a pack (using the optimal Lagrangian multipliers). 	-<code>yLR</code>: primal solution of the Knapsack Lagrangian Relaxation associated to the variables say if we use or not a pack (using the optimal Lagrangian multipliers). 	-<code>objLR</code>: optimal value of the Lagrangian Dual</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.labelsGA" href="#LearningPi.labelsGA"><code>LearningPi.labelsGA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Label structure for the Generalized Assignment Problem. 	#Fields: 	-<code>π</code>: optimal lagrangian multipliers vector. 	-<code>xLR</code>: primal solution of the Lagrangian Subproblem with optimal Lagrangian multipliers. 	-<code>objLR</code>: optimal value of the Lagrangian Dual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.learningType" href="#LearningPi.learningType"><code>LearningPi.learningType</code></a> — <span class="docstring-category">Type</span></header><section><div><p>abstract learning type to type the functions that should work with all the type of models and features encoding</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.loss_hinge" href="#LearningPi.loss_hinge"><code>LearningPi.loss_hinge</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Structure of parameters for loss obtained as the inverse of the sub-problem obj value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.loss_hinge-Tuple{Any}" href="#LearningPi.loss_hinge-Tuple{Any}"><code>LearningPi.loss_hinge</code></a> — <span class="docstring-category">Method</span></header><section><div><p>lossHinge(π; example, _::HingeLoss)</p><p>Loss function obtained taking the inverse of the sub-problem value for the predicted lagrangians.</p><p><strong>Arguments:</strong></p><ul><li><code>π</code>: lagrangian multipliers vector candidate.</li><li><code>example</code>: dataset sample object.</li></ul><p>-<code>_</code>: loss parameters, it should be a structure of type HingeLoss.   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.loss_mse-Tuple{Any}" href="#LearningPi.loss_mse-Tuple{Any}"><code>LearningPi.loss_mse</code></a> — <span class="docstring-category">Method</span></header><section><div><p>loss_mse(π; example)</p><p><strong>Arguments:</strong></p><ul><li><code>π</code>: lagrangian multipliers vector candidate.</li><li><code>example</code>: dataset sample object.</li></ul><p>-<code>_</code>: loss parameters, it should be a structure of type MSELoss.   </p><p>returns the loss function value obtained taking the MSE beteern the predicted Lagrangian multipliers <code>π</code> and the optimal ones in <code>example</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.lr_features_matrix" href="#LearningPi.lr_features_matrix"><code>LearningPi.lr_features_matrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct <code>lr_features_matrix</code></p><p>with this choice the features matrix considers the informations related to the continuous relaxation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.without_cr_features_matrix" href="#LearningPi.without_cr_features_matrix"><code>LearningPi.without_cr_features_matrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct <code>withou_cr_features_matrix</code></p><p>with this choice the features matrix does not considers the informations related to the continuous relaxation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.zero_deviation" href="#LearningPi.zero_deviation"><code>LearningPi.zero_deviation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct zero_deviation end</p><p>Type to use as deviation vector (i.e. the starting point from which our model produce an additive activation) the all zeros vector. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChainRulesCore.rrule-Tuple{LearningPi.loss_LR, AbstractArray}" href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_LR, AbstractArray}"><code>ChainRulesCore.rrule</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute the value of the Learning by Experience loss (usining the inverse of value of the sub-problem) and its pullback function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChainRulesCore.rrule-Tuple{LearningPi.loss_LR_gpu, AbstractArray}" href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_LR_gpu, AbstractArray}"><code>ChainRulesCore.rrule</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute the value of the Learning by Experience loss (usining the inverse of value of the sub-problem) and its pullback function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChainRulesCore.rrule-Tuple{LearningPi.loss_hinge, AbstractArray}" href="#ChainRulesCore.rrule-Tuple{LearningPi.loss_hinge, AbstractArray}"><code>ChainRulesCore.rrule</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute the value of the Learning by Experience loss (usining the inverse of value of the sub-problem) and its pullback function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.compareWithBests-Tuple{Dict, Dict, Any, Any}" href="#LearningPi.compareWithBests-Tuple{Dict, Dict, Any, Any}"><code>LearningPi.compareWithBests</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function compareWithBests(currentMetrics::Dict,bestMetrics::Dict,nn,endString::String)</p><p><strong>Arguments:</strong></p><ul><li><code>currentMetrics</code> : a dictionary of Float </li><li><code>bestMetrics</code> : a dictionary of Float </li><li><code>nn</code> : a neural network</li><li><code>endString</code> : a string used to memorize the best models</li></ul><p>This function compare all the values in <code>bestMetrics</code> with the ones in <code>currentMetrics</code> (that corresponds to the same key). If some value in <code>currentMetrics</code> is better, then we update the correspondent value in <code>bestMetrics</code> and we save the model in a bson file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createEmptyDataset-Tuple{LearningPi.learningGNN}" href="#LearningPi.createEmptyDataset-Tuple{LearningPi.learningGNN}"><code>LearningPi.createEmptyDataset</code></a> — <span class="docstring-category">Method</span></header><section><div><p>createEmptyDataset(lt::learningGNN)</p><p><strong>Arguments:</strong></p><ul><li><code>lt</code>: learning Multi Layer Perceptron type.</li></ul><p>Create an empty dataset for the Graph Neural network learning type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.createEmptyDataset-Tuple{LearningPi.learningMLP}" href="#LearningPi.createEmptyDataset-Tuple{LearningPi.learningMLP}"><code>LearningPi.createEmptyDataset</code></a> — <span class="docstring-category">Method</span></header><section><div><p>createEmptyDataset(lt::learningMLP)</p><p><strong>Arguments:</strong></p><ul><li>lt: learning Multi Layer Perceptron type.</li></ul><p>Create an empty dataset for the  Multi Layer Perceptron learning type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_features-Tuple{Instances.instanceGA}" href="#LearningPi.create_features-Tuple{Instances.instanceGA}"><code>LearningPi.create_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function create_features(ins::instanceGA)</p><pre><code class="nohighlight hljs">#Arguments:
	- `ins`: instance object, it should be of type instanceGA 

read the features and returns a features structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_features-Tuple{cpuInstanceMCND}" href="#LearningPi.create_features-Tuple{cpuInstanceMCND}"><code>LearningPi.create_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function create_features(ins::cpuInstanceMCND)</p><p>#Arguments:</p><ul><li><code>ins</code>: instance structure, should be of type cpuInstanceMCND</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_features-Tuple{instanceCWL}" href="#LearningPi.create_features-Tuple{instanceCWL}"><code>LearningPi.create_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function create_features(ins::instanceCWL)</p><pre><code class="nohighlight hljs">#Arguments:
	- `ins`: instance object, it should be of type instanceCWL 

solve the Continuous Relaxation and the Lagrangian Sub-Problem considering as Lagrangian Multipliers
the dual variables associated to the relaxed constraints and then returns a features structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.create_rms-Tuple{Any}" href="#LearningPi.create_rms-Tuple{Any}"><code>LearningPi.create_rms</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function create_rms(d)</p><p>#Arguments:</p><ul><li><code>d</code>: size of input in the input layers</li></ul><p>return a RMSNorm function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.deviationFrom-Tuple{Any, LearningPi.cr_deviation}" href="#LearningPi.deviationFrom-Tuple{Any, LearningPi.cr_deviation}"><code>LearningPi.deviationFrom</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function deviationFrom(x,<em>::cr</em>deviation)</p><p>#Arguments:</p><ul><li><code>x</code>: the bipartite-graph representation of the instance</li></ul><p>For the <code>cr_deviation</code> it returns the dual variables associated to the dualized constraints in the optimal solution of the continuous relaxation, taking the good components from the nodes features matrix in the bipartite-graph representation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.deviationFrom-Tuple{Any, LearningPi.zero_deviation}" href="#LearningPi.deviationFrom-Tuple{Any, LearningPi.zero_deviation}"><code>LearningPi.deviationFrom</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function deviationFrom(x,<em>::zero</em>deviation)</p><p>#Arguments:</p><ul><li><code>x</code>: the bipartite-graph representation of the instance</li></ul><p>For the <code>zero_deviation</code> it returns an all-zeros vector with the correct size. The size will be the same as the dual variables associated to the dualized constraints in the optimal solution of the continuous relaxation, taking the good components from the nodes features matrix in the bipartite-graph representation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.features_matrix-Tuple{Instances.instanceGA, Any, LearningPi.abstract_features_matrix}" href="#LearningPi.features_matrix-Tuple{Instances.instanceGA, Any, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function features<em>matrix(ins::instanceGA,featObj, fmt::abstract</em>features_matrix)</p><p>#Arguments:</p><ul><li><code>ins</code>: instance structure, it should be a sub-type of instanceGA</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>fmt</code>: features matrix type.</li></ul><p>Construct the matrix of the features for a bipartite-graph representation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.features_matrix-Tuple{abstractInstanceMCND, LearningPi.featuresMCND, LearningPi.abstract_features_matrix}" href="#LearningPi.features_matrix-Tuple{abstractInstanceMCND, LearningPi.featuresMCND, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function features<em>matrix(ins::instanceMCND, featObj::featuresMCND, fmt::abstract</em>features_matrix)</p><p>#Arguments:</p><ul><li><code>ins</code>: instance structure, it should be a sub-type of abstractInstanceMCND</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>fmt</code>: features matrix type.</li></ul><p>Construct the matrix of the features for a bipartite-graph representation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.features_matrix-Tuple{instanceCWL, Any, LearningPi.abstract_features_matrix}" href="#LearningPi.features_matrix-Tuple{instanceCWL, Any, LearningPi.abstract_features_matrix}"><code>LearningPi.features_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function features<em>matrix(ins::instanceCWL,featObj, fmt::abstract</em>features_matrix)</p><p>#Arguments:</p><ul><li><code>ins</code>: instance structure, it should be a sub-type of instanceCWL</li><li><code>featObj</code>: features object containing all the characteristics </li><li><code>fmt</code>: features matrix type.</li></ul><p>Construct the matrix of the features for a bipartite-graph representation of the instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.gap-Tuple{LearningPi.abstract_example, Real, Real, Real}" href="#LearningPi.gap-Tuple{LearningPi.abstract_example, Real, Real, Real}"><code>LearningPi.gap</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function gap(example::abstract_example, objPred::Real, objGold::Real, nInst::Real)</p><p>#Arguments:</p><ul><li><code>example</code>: the current example (dataset point).</li><li><code>objPred</code>: the current obective for the example.</li><li><code>objGold</code>: the optimal value of the Lagrangian Dual.</li><li><code>nInst</code>: the number of the instances in the set.</li></ul><p>compute the GAP of the instance in the <code>example</code> using the predicted objective <code>objPred</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.gap_closure-Tuple{LearningPi.abstract_example, Real, Real, Real}" href="#LearningPi.gap_closure-Tuple{LearningPi.abstract_example, Real, Real, Real}"><code>LearningPi.gap_closure</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function gap(example::abstract_example, objPred::Real, objGold::Real, nInst::Real)</p><p>#Arguments:</p><ul><li><code>example</code>: the current example (dataset point).</li><li><code>objPred</code>: the current obective for the example.</li><li><code>objGold</code>: the optimal value of the Lagrangian Dual.</li><li><code>nInst</code>: the number of the instances in the set.</li></ul><p>compute the closure GAP of the instance in the <code>example</code> using the predicted objective <code>objPred</code>. The closure is w.r.t. the value of the Lagrangian Sub-Problem, solved with the dual variables of the continuous relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_cr_features-Tuple{LearningPi.cr_features_matrix, Any, Any, Any}" href="#LearningPi.get_cr_features-Tuple{LearningPi.cr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function cr<em>features(fmt::cr</em>features_matrix, x, y)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_cr_features-Tuple{LearningPi.lr_features_matrix, Any, Any, Any}" href="#LearningPi.get_cr_features-Tuple{LearningPi.lr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function cr<em>features(fmt::lr</em>features_matrix, x, y)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be lr<em>features</em>matrix) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_cr_features-Tuple{LearningPi.without_cr_features_matrix, Any, Any, Any}" href="#LearningPi.get_cr_features-Tuple{LearningPi.without_cr_features_matrix, Any, Any, Any}"><code>LearningPi.get_cr_features</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function cr<em>features(fmt::without</em>cr<em>features</em>matrix, _, _)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be without<em>cr</em>features_matrix) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_device-Tuple{LearningPi.abstract_loss}" href="#LearningPi.get_device-Tuple{LearningPi.abstract_loss}"><code>LearningPi.get_device</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function get<em>device(los::abstract</em>loss)</p><pre><code class="nohighlight hljs">#Arguments:
- `_`: the loss parameters

returns the device (cpu/gpu) used to compute the loss.
For a general loss will be CPU.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_model-Tuple{LearningPi.Graphormer}" href="#LearningPi.get_model-Tuple{LearningPi.Graphormer}"><code>LearningPi.get_model</code></a> — <span class="docstring-category">Method</span></header><section><div><p>get_model(nn::GNNChain)</p><p>#Arguments: 	-<code>nn</code>: neural network model</p><p>returns a cpu version of the model that can be saved using a bson file.    </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_parameters" href="#LearningPi.get_parameters"><code>LearningPi.get_parameters</code></a> — <span class="docstring-category">Function</span></header><section><div><p>function get_parameters(nn, lt::learningType, f = 0)</p><ul><li><code>nn</code> : neural network</li><li><code>lt</code> : learning type</li><li><code>f</code> :  ???</li></ul><p>Returns the model parameters of <code>nn</code> in the case in which nn belsong to <code>lt</code> learning type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.get_λ-Tuple{Any}" href="#LearningPi.get_λ-Tuple{Any}"><code>LearningPi.get_λ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function get_λ(x)</p><p>#Arguments:</p><ul><li><code>x</code>: the bipartite-graph representation of the instance</li></ul><p>Returns the dual variables associated to the dualized constraints in the optimal solution of the continuous relaxation, taking the good components from the nodes features matrix in the bipartite-graph representation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, Instances.cpuInstanceGA}" href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, Instances.cpuInstanceGA}"><code>LearningPi.gradient_lsp</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function gradient_lsp( x, ins::cpuInstanceGA)</p><pre><code class="nohighlight hljs">#Arguments:
- `x`: the solution of the Lagrangian Sub-problem
- `ins`: a cpuInstanceCWL structure</code></pre><p>This function compute and returns the gradient of the sub-problem objective function w.r.t. the Lagrangian Multipliers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceCWL}" href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceCWL}"><code>LearningPi.gradient_lsp</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function gradient_lsp( x, ins::cpuInstanceCWL)</p><pre><code class="nohighlight hljs">#Arguments:
- `x`: the solution of the Lagrangian Sub-problem
- `ins`: a cpuInstanceCWL structure</code></pre><p>This function compute and returns the gradient of the sub-problem objective function w.r.t. the Lagrangian Multipliers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceMCND}" href="#LearningPi.gradient_lsp-Tuple{AbstractVecOrMat, cpuInstanceMCND}"><code>LearningPi.gradient_lsp</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function gradient_lsp( x, ins::cpuInstanceMCND)</p><pre><code class="nohighlight hljs">#Arguments:
- `x`: the solution of the Lagrangian Sub-problem
- `ins`: a cpuInstanceMCND structure</code></pre><p>This function compute and returns the gradient of the sub-problem objective function w.r.t. the Lagrangian Multipliers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.printBests-Tuple{Dict, String}" href="#LearningPi.printBests-Tuple{Dict, String}"><code>LearningPi.printBests</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function printBests(bestMetrics::Dict, path::String)</p><p><strong>Arguments:</strong></p><ul><li><code>bestMetrics</code>: a dictionary of float that contains the best values</li></ul><pre><code class="nohighlight hljs">		   find in the training for altypel the considered metrics.</code></pre><ul><li><code>path</code>: location where print the results in a file.				</li></ul><p>Takes as input the dictionary of the best metrics and print the values in standard output and in a file defined by the <code>path</code>.                </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.printMetrics-Tuple{Dict}" href="#LearningPi.printMetrics-Tuple{Dict}"><code>LearningPi.printMetrics</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function printMetrics(currentMetrics::Dict)</p><p><strong>Arguments:</strong></p><ul><li><code>currentMetrics</code>: a dictionary of Float</li></ul><p>This function takes as input the dictionary of the metrics and print the values associated to training and validation sets.    </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.print_best_models-Tuple{String, Dict}" href="#LearningPi.print_best_models-Tuple{String, Dict}"><code>LearningPi.print_best_models</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function print<em>best</em>models(endString::String, bestModels::Dict)</p><p>#Arguments:</p><ul><li><code>endString</code>: Path where save the models </li><li><code>bestModels</code>: Dictionary of the best models (w.r.t different metrics) found so far</li></ul><p>Print in a file BSON, located in the folder <code>endString</code> the best model found so far </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.print_json-Tuple{Any, Any, Any, Any, cpuMCNDinstanceFactory}" href="#LearningPi.print_json-Tuple{Any, Any, Any, Any, cpuMCNDinstanceFactory}"><code>LearningPi.print_json</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function print_json(ins::cpuInstanceMCND, lab, feat, fileName,factory::cpuMCNDinstanceFactory)</p><p>#Arguments:    </p><ul><li><code>ins</code>: instance structure, it should be of type CWLinstance</li><li><code>lab</code>: labels structure, it should be of type labelsMCND</li><li><code>feat</code>: features structure, it should be of type featuresMCND</li><li><code>fileName</code>: the path to the file json where print the data</li><li><code>factory</code>: instance factory should be of type cpuMCNDinstanceFactory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.print_json-Tuple{Instances.instanceGA, LearningPi.labelsGA, LearningPi.featuresGA, String}" href="#LearningPi.print_json-Tuple{Instances.instanceGA, LearningPi.labelsGA, LearningPi.featuresGA, String}"><code>LearningPi.print_json</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function print_json(ins::instanceGA, lab::labelsGA, feat::featuresGA, fileName::String)</p><p>#Arguments:     -<code>ins</code>: instance structure, it should be of type &lt;: instanceGA</p><ul><li><code>lab</code>: labels structure, it should be of type labelsGA</li><li><code>feat</code>: features structure, it should be of type featuresGA</li><li><code>fileName</code>: the path to the file json where print the data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.print_json-Tuple{instanceCWL, LearningPi.labelsCWL, LearningPi.featuresCWL, String}" href="#LearningPi.print_json-Tuple{instanceCWL, LearningPi.labelsCWL, LearningPi.featuresCWL, String}"><code>LearningPi.print_json</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function print_json(ins::instanceCWL, lab::labelsCWL, feat::featuresCWL, fileName::String)</p><p>#Arguments:     -<code>ins</code>: instance structure, it should be of type &lt;: instanceCWL</p><ul><li><code>lab</code>: labels structure, it should be of type labelsCWL</li><li><code>feat</code>: features structure, it should be of type featuresCWL</li><li><code>fileName</code>: the path to the file json where print the data</li></ul><p>Print the information provided in the instance <code>ins</code>, the labels <code>lab</code> and the features <code>feat</code> in a JSON file located in the path <code>fileName</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.read_labels-Tuple{String, Instances.instanceGA}" href="#LearningPi.read_labels-Tuple{String, Instances.instanceGA}"><code>LearningPi.read_labels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function read_labels(fileLabel::String, ins::instanceGA)</p><pre><code class="nohighlight hljs">#Arguments:
	- `fileLabel`: the path to the file where to find labels informations
	- `ins`: instance object, it should be sub-type of instanceGA 

read the labels and returns a labels structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.read_labels-Tuple{String, abstractInstanceMCND}" href="#LearningPi.read_labels-Tuple{String, abstractInstanceMCND}"><code>LearningPi.read_labels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function read_labels(fileLabel::String, ins::abstractInstanceMCND)</p><pre><code class="nohighlight hljs">#Arguments:
	- `fileLabel`: the path to the file where to find labels informations
	- `ins`: instance object, it should be of type abstractInstanceMCND 

read the labels and returns a labels structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.read_labels-Tuple{String, instanceCWL}" href="#LearningPi.read_labels-Tuple{String, instanceCWL}"><code>LearningPi.read_labels</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function read_labels(fileLabel::String, ins::instanceCWL)</p><pre><code class="nohighlight hljs">#Arguments:
	- `fileLabel`: the path to the file where to find labels informations
	- `ins`: instance object, it should be of type sub-type of instanceCWL 

read the labels and returns a labels structure.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningGNN, LearningPi.abstract_features_matrix, LearningPi.abstract_deviation, Any, Int64, Int64, Vararg{Any, 7}}" href="#LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningGNN, LearningPi.abstract_features_matrix, LearningPi.abstract_deviation, Any, Int64, Int64, Vararg{Any, 7}}"><code>LearningPi.saveHP</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function saveHP(endString::String,lr::Float32,decay::Float32,h::Vector{Int64},opt,lt::learningType,loss,seedNN::Int64,seedDS::Int64,stepSize::Int64)</p><p><strong>Arguments:</strong></p><ul><li><code>endString</code>: a string used as name for the output file.</li><li><code>lr</code>: learning rate of the algorithm.</li><li><code>decay</code>: decay for the learning rate.</li><li><code>h</code>: a list of #(hidden layers), each component of h contains the number of nodes in</li></ul><pre><code class="nohighlight hljs"> the associated hidden layer.</code></pre><ul><li><code>opt</code>: optimizer</li><li><code>lt</code>: learning type object.     </li><li><code>fmt</code>:</li><li><code>dt</code>:</li><li><code>loss</code>: loss function.</li><li><code>seedDS</code>: random seed for the dataset generation.</li><li><code>seedNN</code>: random seed for the neural network parameters.</li><li><code>stepSize</code>: the step size for the decay scheduler of the optimizer</li><li><code>nodes_number</code>: size (number of nodes) in the hidden reprensentation between each layer</li><li><code>block_number</code>: number of blocks in the model</li><li><code>hI</code>: sizes of Dense layers in the first part, where the nodes features are sent in the hidden space</li><li><code>hF</code>: sizes of Dense layers in the final</li><li><code>dataPath</code>: path to the instances used in the dataset</li><li><code>factory</code>: instance factory type</li></ul><p>This function memorize all this hyper parameters in a JSON file.     </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningType, Any, Int64, Int64, Any}" href="#LearningPi.saveHP-Tuple{String, Float32, Float32, Vector{Int64}, Any, LearningPi.learningType, Any, Int64, Int64, Any}"><code>LearningPi.saveHP</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function saveHP(endString::String,lr::Float32,decay::Float32,h::Vector{Int64}, opt, lt::learningType, loss,seedNN::Int64, seedDS::Int64, stepSize::Int64)</p><p><strong>Arguments:</strong></p><ul><li><code>endString</code>: a string used as name for the output file.</li><li><code>lr</code>: learning rate of the algorithm.</li><li><code>decay</code>: decay for the learning rate.</li><li><code>h</code>: a list of #(hidden layers), each component of h contains the number of nodes in</li></ul><pre><code class="nohighlight hljs"> the associated hidden layer.</code></pre><ul><li><code>opt</code>: optimizer</li><li><code>lt</code>: learning type object.     </li><li><code>loss</code>: loss function.</li><li><code>seedDS</code>: random seed for the dataset generation.</li><li><code>seedNN</code>: random seed for the neural network parameters.</li><li><code>stepSize</code>: the step size for the decay scheduler of the optimizer</li></ul><p>This function memorize all this hyper parameters in a JSON file.     </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.sizeFeatures-Tuple{LearningPi.learningMLP, Any}" href="#LearningPi.sizeFeatures-Tuple{LearningPi.learningMLP, Any}"><code>LearningPi.sizeFeatures</code></a> — <span class="docstring-category">Method</span></header><section><div><p>sizeFeatures(lt::learningType,dS)</p><p><strong>Arguments:</strong></p><ul><li><code>lt</code> : learning type (general).</li><li><code>dS</code> : dataset (corpus structure)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_constraint-Tuple{LearningPi.cr_features_matrix}" href="#LearningPi.size_features_constraint-Tuple{LearningPi.cr_features_matrix}"><code>LearningPi.size_features_constraint</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>constraint(fmt::cr<em>features</em>matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the constraints. In this case 6.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_constraint-Tuple{LearningPi.lr_features_matrix}" href="#LearningPi.size_features_constraint-Tuple{LearningPi.lr_features_matrix}"><code>LearningPi.size_features_constraint</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>constraint(fmt::lr<em>features</em>matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the constraints. In this case 6.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_constraint-Tuple{LearningPi.without_cr_features_matrix}" href="#LearningPi.size_features_constraint-Tuple{LearningPi.without_cr_features_matrix}"><code>LearningPi.size_features_constraint</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>constraint(fmt::without<em>cr</em>features_matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the constraints. In this case 4.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_variable-Tuple{LearningPi.cr_features_matrix}" href="#LearningPi.size_features_variable-Tuple{LearningPi.cr_features_matrix}"><code>LearningPi.size_features_variable</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>variable(fmt::cr<em>features</em>matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the variables. In this case 4.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_variable-Tuple{LearningPi.lr_features_matrix}" href="#LearningPi.size_features_variable-Tuple{LearningPi.lr_features_matrix}"><code>LearningPi.size_features_variable</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>variable(fmt::lr<em>features</em>matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the variables. In this case 4.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.size_features_variable-Tuple{LearningPi.without_cr_features_matrix}" href="#LearningPi.size_features_variable-Tuple{LearningPi.without_cr_features_matrix}"><code>LearningPi.size_features_variable</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function size<em>features</em>variable(fmt::without<em>cr</em>features_matrix)</p><p>#Arguments: -<code>fmt</code>: feature matrix type (it shoul be cr<em>features</em>matrix) </p><p>returns the size of the features associated to the variables. In this case 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.abstract_loss}" href="#LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.abstract_loss}"><code>LearningPi.sub_problem_value</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function sub<em>problem</em>value(<em>, v, example, _::abstract</em>loss)</p><p>#Arguments:</p><ul><li><code>_</code>: lagrangian multipliers vector candidate, </li><li><code>v</code>: the value of the loss function,</li><li><code>example</code>: dataset sample object,</li><li><code>_</code>: loss parameters.</li></ul><p>Compute the value of the sub-problem for the loss for which it cannot be obtained in a smarter way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.loss_hinge}" href="#LearningPi.sub_problem_value-Tuple{Any, Any, Any, LearningPi.loss_hinge}"><code>LearningPi.sub_problem_value</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function sub<em>problem</em>value(_, v, example, _::HingeLoss)</p><p>#Arguments:</p><ul><li><code>_</code>: lagrangian multipliers vector candidate, </li><li><code>v</code>: the value of the loss function,</li><li><code>example</code>: dataset sample object,</li><li><code>_</code>: loss parameters, it should be a structure of type HingeLoss.   </li></ul><p>Compute the value of the sub-problem without recomputing it, but using the value of the loss function (for the HingeLoss)  and other informations contained in the sample</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.testAndPrint-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}" href="#LearningPi.testAndPrint-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}"><code>LearningPi.testAndPrint</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function testAndPrint(currentMetrics::Dict,testSet,nn,loss,loss,lt::learningType)</p><p><strong>Arguments:</strong></p><ul><li><code>currentMetrics</code>: a dictionary of Float </li><li><code>testSet</code> : a vector of hingeExamples_instance that correspond to the test set.</li><li><code>nn</code> : a neural network model.</li><li><code>loss</code>: a structure with the parameters of the loss.</li></ul><pre><code class="nohighlight hljs">		   For other details of the parameters of a certain loss see the definition of the particular structure of the loss.</code></pre><ul><li><code>lt</code>: learning type object.     </li></ul><p>This function compute different metrics over the validation set. The values are memorized in the dictionary and print them in the standard output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LearningPi.validation-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}" href="#LearningPi.validation-Tuple{Dict, Any, Any, Any, LearningPi.learningType, LearningPi.abstract_deviation}"><code>LearningPi.validation</code></a> — <span class="docstring-category">Method</span></header><section><div><p>function validation(currentMetrics::Dict, valSet, nn,loss::abstractLoss,  lt::learningType,dt::abstract_deviation)</p><p><strong>Arguments:</strong></p><ul><li><code>currentMetrics</code>: a dictionary of Float </li><li><code>valSet</code> : a vector of gnn_dataset that correspond to the validation set.</li><li><code>nn</code> : a neural network model.</li><li><code>loss</code>: a structure with the parameters of the loss.</li></ul><pre><code class="nohighlight hljs">	   For other details of the parameters of a certain loss see the definition of the particular structure of the loss.</code></pre><ul><li><code>loss</code>: loss function.</li><li><code>lt</code>: learning type object.       </li><li><code>dt</code>: deviation type (0 or dual of the CR)        </li></ul><p>This function compute different metrics over the validation set. The values are memorized in the dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FDemelas/Learning_Lagrangian_Multipliers.jl/-/blob/main/src/LearningPi.jl">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Training/">« Training Scripts</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 4 June 2024 07:35">Tuesday 4 June 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
